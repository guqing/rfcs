## 插件化功能设计

实现 Halo 插件化系统，以便对核心功能进行扩展，在不缺失主要功能的同时防止 Core 过大。插件能力有助于社区生态的构建。

### 目标

后端插件化

- 后端支持 API 拓展机制，提供统一的 API 聚合，通过 core 的访问控制模块（IAM） 进行统一鉴权。
- 支持扩展点机制，插件通过实现 core 中暴露的扩展点接口来增强 core 的能力，如扩展附件存储提供者。
- 插件允许通过 core 提供的数据持久化机制来进行数据操作（CRUD）。
- 插件允许调用 core 提供的公开接口对 core 的数据进行操作

前端插件化

- 前端项目支持插件化，可通过插件在各级导航栏插入新的功能入口，实现功能页面的动态添加。

- 通过固定协议加载插件中提供的前端页面或JS来扩展前端功能

公共目标

- 插件管理：提供可视化的插件管理机制，支持插件的安装、卸载、启用、停用、配置、升级
- 插件仓库：提供插件的打包、发布机制，提供内置的插件仓库。
- 插件框架：提供插件开发、打包、发布相关的脚手架，提供完善的插件开发文档。

### 非目标

- 插件安全检查
- 插件代码风格检查

### 背景和动机

目前 1.0 版本中社区提出了很多非普适功能的 issue，为了控制 core 的大小会挑选重要的功能进行实现， 这对使用者来说很不方便。

如果增加了插件化能力，社区可以根据自己的需要进行插件开发以扩展核心功能，使用者也可以在插件仓库查找自己需要的插件来满足功能。

该功能的实现会很大程度的提高社区活跃度并壮大社区，同时很多在 1.0 版本中加入的许多功能都可以抽取为独立插件以减小 core 的大小，使用者可以按需插拔功能使 halo 更加灵活。

### 设计

#### Backend

通过 PluginManager 对插件进行管理

插件加载：

1. 系统默认插件的加载
2. 用户已启用的插件的加载
3. Halo 运行时对用户启用的插件进行加载

插件停用：

1. 停用已注册的APIs
2. 停用已注册的扩展点
3. 停用已加载的静态资源
4. 停用诸如监听器之类的其他资源

插件卸载：

1. 卸载已加载的类
2. 清理插件静态资源缓存
3. 清理插件配置数据和模型数据

插件升级：

通过插件的版本号及对 Halo 版本的依赖进行判断，提供检查更新机制。

提供升级方式，主要考虑两种：

1. 通过上传插件文件进行升级
2. 通过插件仓库进行远程升级

#### Frontend

TBD